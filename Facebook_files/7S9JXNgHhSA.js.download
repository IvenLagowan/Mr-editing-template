;/*FB_PKG_DELIM*/

__d("LSInsertIcebreakerData",["LSArrayGetObjectAt","LSGetFirstAvailableThreadNullstateCTAID"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.seq([function(b){return c.seq([function(b){return c.db.table(29).fetch([[[a[0]]],"threadKeyCtaId"]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[1]=f:(b=a.item,d[1]=b.ctaId)})},function(a){return d[0]=d[1]}])},function(e){return c.i64.eq(d[0],f)?c.seq([function(a){return c.sp(b("LSGetFirstAvailableThreadNullstateCTAID")).then(function(a){return a=a,d[1]=a[0],a})},function(e){return d[2]=c.i64.of_int32(a[1].length),c.i64.gt(d[2],[0,0])?c.loopAsync(d[2],function(e){return d[3]=e,c.seq([function(e){return c.ntop("Array",b("LSArrayGetObjectAt"),a[1],d[3]).then(function(a){return a=a,d[4]=a[0],d[5]=a[1],a})},function(a){return d[6]=d[4].get("thread_key"),d[4],d[7]=d[4].get("title"),d[4],d[8]=d[4].get("cta_type"),d[4],d[9]=d[4].get("platform_token"),d[4],c.db.table(29).add({ctaId:c.i64.add(d[1],d[3]),threadKey:d[6],title:d[7],ctaType:d[8],platformToken:d[9]})}])}):c.resolve()}]):c.resolve()}])},function(a){return c.resolve(e)}])}e.exports=a}),null);